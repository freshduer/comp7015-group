==========================================
DistilBert training test (RTX 4090)
==========================================
Job ID: 4281
Node: gpu10
GPU: 1
Working directory: /home/comp/zhanzhao/comp7015-group/bert
==========================================
transformers/datasets ready. torch cuda: True
Raw splits ready. Train/Val/Test = 20000 2500 2500
{'loss': 0.6953, 'grad_norm': 1.6067534685134888, 'learning_rate': 1.568e-06, 'epoch': 0.04}
{'loss': 0.6897, 'grad_norm': 2.014141321182251, 'learning_rate': 3.1680000000000004e-06, 'epoch': 0.08}
{'loss': 0.6769, 'grad_norm': 2.2255773544311523, 'learning_rate': 4.768000000000001e-06, 'epoch': 0.12}
{'loss': 0.5902, 'grad_norm': 2.5444397926330566, 'learning_rate': 6.368000000000001e-06, 'epoch': 0.16}
{'loss': 0.3907, 'grad_norm': 4.060910224914551, 'learning_rate': 7.968e-06, 'epoch': 0.2}
{'loss': 0.3059, 'grad_norm': 3.448002576828003, 'learning_rate': 9.568e-06, 'epoch': 0.24}
{'loss': 0.3075, 'grad_norm': 12.569864273071289, 'learning_rate': 1.1168e-05, 'epoch': 0.28}
{'loss': 0.3133, 'grad_norm': 6.239380836486816, 'learning_rate': 1.2768e-05, 'epoch': 0.32}
{'loss': 0.3323, 'grad_norm': 4.828409671783447, 'learning_rate': 1.4368000000000002e-05, 'epoch': 0.36}
{'loss': 0.33, 'grad_norm': 4.031517028808594, 'learning_rate': 1.5968e-05, 'epoch': 0.4}
{'loss': 0.3048, 'grad_norm': 16.704578399658203, 'learning_rate': 1.7568000000000002e-05, 'epoch': 0.44}
{'loss': 0.2681, 'grad_norm': 0.5372047424316406, 'learning_rate': 1.9168000000000004e-05, 'epoch': 0.48}
{'loss': 0.307, 'grad_norm': 4.585378170013428, 'learning_rate': 1.9914666666666668e-05, 'epoch': 0.52}
{'loss': 0.2833, 'grad_norm': 3.613398790359497, 'learning_rate': 1.973688888888889e-05, 'epoch': 0.56}
{'loss': 0.3009, 'grad_norm': 0.8555526733398438, 'learning_rate': 1.9559111111111113e-05, 'epoch': 0.6}
{'loss': 0.2678, 'grad_norm': 12.521862983703613, 'learning_rate': 1.9381333333333334e-05, 'epoch': 0.64}
{'loss': 0.3005, 'grad_norm': 9.989773750305176, 'learning_rate': 1.9203555555555558e-05, 'epoch': 0.68}
{'loss': 0.3114, 'grad_norm': 0.941297709941864, 'learning_rate': 1.902577777777778e-05, 'epoch': 0.72}
{'loss': 0.2882, 'grad_norm': 4.269746780395508, 'learning_rate': 1.8848000000000003e-05, 'epoch': 0.76}
{'loss': 0.2455, 'grad_norm': 13.91464900970459, 'learning_rate': 1.8670222222222224e-05, 'epoch': 0.8}
{'loss': 0.307, 'grad_norm': 11.947855949401855, 'learning_rate': 1.8492444444444445e-05, 'epoch': 0.84}
{'loss': 0.2931, 'grad_norm': 5.244375228881836, 'learning_rate': 1.8314666666666666e-05, 'epoch': 0.88}
{'loss': 0.2676, 'grad_norm': 0.3838455379009247, 'learning_rate': 1.813688888888889e-05, 'epoch': 0.92}
{'loss': 0.2894, 'grad_norm': 8.182493209838867, 'learning_rate': 1.795911111111111e-05, 'epoch': 0.96}
{'loss': 0.2726, 'grad_norm': 9.368879318237305, 'learning_rate': 1.7781333333333335e-05, 'epoch': 1.0}
{'eval_loss': 0.30847620964050293, 'eval_accuracy': 0.8956, 'eval_f1': 0.8916562889165629, 'eval_runtime': 4.7891, 'eval_samples_per_second': 522.014, 'eval_steps_per_second': 16.496, 'epoch': 1.0}
{'loss': 0.2284, 'grad_norm': 2.2197225093841553, 'learning_rate': 1.7603555555555556e-05, 'epoch': 1.04}
{'loss': 0.1931, 'grad_norm': 0.7718260288238525, 'learning_rate': 1.742577777777778e-05, 'epoch': 1.08}
{'loss': 0.2372, 'grad_norm': 11.714865684509277, 'learning_rate': 1.7248e-05, 'epoch': 1.12}
{'loss': 0.1973, 'grad_norm': 0.11404378712177277, 'learning_rate': 1.7070222222222222e-05, 'epoch': 1.16}
{'loss': 0.2175, 'grad_norm': 10.086394309997559, 'learning_rate': 1.6892444444444447e-05, 'epoch': 1.2}
{'loss': 0.1421, 'grad_norm': 0.07506909966468811, 'learning_rate': 1.6714666666666668e-05, 'epoch': 1.24}
{'loss': 0.2321, 'grad_norm': 4.745739459991455, 'learning_rate': 1.6536888888888892e-05, 'epoch': 1.28}
{'loss': 0.2158, 'grad_norm': 7.084619522094727, 'learning_rate': 1.6359111111111113e-05, 'epoch': 1.32}
{'loss': 0.2043, 'grad_norm': 0.17650094628334045, 'learning_rate': 1.6181333333333337e-05, 'epoch': 1.36}
{'loss': 0.1913, 'grad_norm': 5.718565940856934, 'learning_rate': 1.6003555555555558e-05, 'epoch': 1.4}
{'loss': 0.2077, 'grad_norm': 16.988243103027344, 'learning_rate': 1.582577777777778e-05, 'epoch': 1.44}
{'loss': 0.2168, 'grad_norm': 5.508140563964844, 'learning_rate': 1.5648e-05, 'epoch': 1.48}
{'loss': 0.1999, 'grad_norm': 4.094873428344727, 'learning_rate': 1.5470222222222224e-05, 'epoch': 1.52}
{'loss': 0.2009, 'grad_norm': 7.056920528411865, 'learning_rate': 1.5292444444444445e-05, 'epoch': 1.56}
{'loss': 0.2331, 'grad_norm': 5.420949935913086, 'learning_rate': 1.5114666666666668e-05, 'epoch': 1.6}
{'loss': 0.2083, 'grad_norm': 11.548260688781738, 'learning_rate': 1.493688888888889e-05, 'epoch': 1.64}
{'loss': 0.2231, 'grad_norm': 2.0625877380371094, 'learning_rate': 1.4759111111111113e-05, 'epoch': 1.68}
{'loss': 0.2024, 'grad_norm': 1.347830891609192, 'learning_rate': 1.4581333333333334e-05, 'epoch': 1.72}
{'loss': 0.1892, 'grad_norm': 1.6497023105621338, 'learning_rate': 1.4403555555555556e-05, 'epoch': 1.76}
{'loss': 0.1988, 'grad_norm': 1.6304447650909424, 'learning_rate': 1.4225777777777779e-05, 'epoch': 1.8}
{'loss': 0.2328, 'grad_norm': 5.15161657333374, 'learning_rate': 1.4048000000000002e-05, 'epoch': 1.84}
{'loss': 0.2321, 'grad_norm': 3.6791365146636963, 'learning_rate': 1.3870222222222223e-05, 'epoch': 1.88}
{'loss': 0.2127, 'grad_norm': 1.4069586992263794, 'learning_rate': 1.3692444444444445e-05, 'epoch': 1.92}
{'loss': 0.1731, 'grad_norm': 4.5599870681762695, 'learning_rate': 1.3514666666666668e-05, 'epoch': 1.96}
{'loss': 0.219, 'grad_norm': 0.547240138053894, 'learning_rate': 1.333688888888889e-05, 'epoch': 2.0}
{'eval_loss': 0.26676326990127563, 'eval_accuracy': 0.9156, 'eval_f1': 0.9165678133649664, 'eval_runtime': 4.7489, 'eval_samples_per_second': 526.435, 'eval_steps_per_second': 16.635, 'epoch': 2.0}
{'loss': 0.0817, 'grad_norm': 1.8504236936569214, 'learning_rate': 1.3159111111111111e-05, 'epoch': 2.04}
{'loss': 0.1494, 'grad_norm': 14.183993339538574, 'learning_rate': 1.2981333333333334e-05, 'epoch': 2.08}
{'loss': 0.1068, 'grad_norm': 0.8214434385299683, 'learning_rate': 1.2803555555555557e-05, 'epoch': 2.12}
{'loss': 0.1144, 'grad_norm': 6.138223648071289, 'learning_rate': 1.262577777777778e-05, 'epoch': 2.16}
{'loss': 0.1118, 'grad_norm': 0.3379492163658142, 'learning_rate': 1.2448e-05, 'epoch': 2.2}
{'loss': 0.1309, 'grad_norm': 6.227349281311035, 'learning_rate': 1.2270222222222223e-05, 'epoch': 2.24}
{'loss': 0.1385, 'grad_norm': 0.12028108537197113, 'learning_rate': 1.2092444444444444e-05, 'epoch': 2.28}
{'loss': 0.124, 'grad_norm': 0.06350123882293701, 'learning_rate': 1.1914666666666668e-05, 'epoch': 2.32}
{'loss': 0.1266, 'grad_norm': 11.169856071472168, 'learning_rate': 1.1736888888888889e-05, 'epoch': 2.36}
{'loss': 0.1441, 'grad_norm': 0.0800105482339859, 'learning_rate': 1.1559111111111111e-05, 'epoch': 2.4}
{'loss': 0.1143, 'grad_norm': 0.41461798548698425, 'learning_rate': 1.1381333333333336e-05, 'epoch': 2.44}
{'loss': 0.1199, 'grad_norm': 0.047955553978681564, 'learning_rate': 1.1203555555555557e-05, 'epoch': 2.48}
{'loss': 0.1214, 'grad_norm': 3.732217788696289, 'learning_rate': 1.102577777777778e-05, 'epoch': 2.52}
{'loss': 0.1335, 'grad_norm': 19.648813247680664, 'learning_rate': 1.0848e-05, 'epoch': 2.56}
{'loss': 0.1065, 'grad_norm': 0.049703340977430344, 'learning_rate': 1.0670222222222224e-05, 'epoch': 2.6}
{'loss': 0.12, 'grad_norm': 0.1596948504447937, 'learning_rate': 1.0492444444444445e-05, 'epoch': 2.64}
{'loss': 0.0949, 'grad_norm': 9.994158744812012, 'learning_rate': 1.0314666666666668e-05, 'epoch': 2.68}
{'loss': 0.1781, 'grad_norm': 0.038674090057611465, 'learning_rate': 1.0136888888888889e-05, 'epoch': 2.72}
{'loss': 0.1222, 'grad_norm': 0.0692116916179657, 'learning_rate': 9.959111111111111e-06, 'epoch': 2.76}
{'loss': 0.0741, 'grad_norm': 0.07993904501199722, 'learning_rate': 9.781333333333334e-06, 'epoch': 2.8}
{'loss': 0.1161, 'grad_norm': 8.19327449798584, 'learning_rate': 9.603555555555557e-06, 'epoch': 2.84}
{'loss': 0.1463, 'grad_norm': 0.10008140653371811, 'learning_rate': 9.425777777777778e-06, 'epoch': 2.88}
{'loss': 0.0962, 'grad_norm': 0.05762966349720955, 'learning_rate': 9.248e-06, 'epoch': 2.92}
{'loss': 0.1258, 'grad_norm': 9.503782272338867, 'learning_rate': 9.070222222222223e-06, 'epoch': 2.96}
{'loss': 0.1425, 'grad_norm': 22.117923736572266, 'learning_rate': 8.892444444444445e-06, 'epoch': 3.0}
{'eval_loss': 0.3699323236942291, 'eval_accuracy': 0.9084, 'eval_f1': 0.9066449245821443, 'eval_runtime': 4.8897, 'eval_samples_per_second': 511.274, 'eval_steps_per_second': 16.156, 'epoch': 3.0}
{'loss': 0.0269, 'grad_norm': 0.09817437082529068, 'learning_rate': 8.714666666666666e-06, 'epoch': 3.04}
{'loss': 0.0477, 'grad_norm': 3.5042452812194824, 'learning_rate': 8.53688888888889e-06, 'epoch': 3.08}
{'loss': 0.0718, 'grad_norm': 0.04510803148150444, 'learning_rate': 8.359111111111112e-06, 'epoch': 3.12}
{'loss': 0.0496, 'grad_norm': 0.023365814238786697, 'learning_rate': 8.181333333333334e-06, 'epoch': 3.16}
{'loss': 0.0738, 'grad_norm': 13.594667434692383, 'learning_rate': 8.003555555555557e-06, 'epoch': 3.2}
{'loss': 0.0735, 'grad_norm': 0.07832495868206024, 'learning_rate': 7.82577777777778e-06, 'epoch': 3.24}
{'loss': 0.0465, 'grad_norm': 0.016467025503516197, 'learning_rate': 7.648e-06, 'epoch': 3.28}
{'loss': 0.1098, 'grad_norm': 0.030000608414411545, 'learning_rate': 7.470222222222223e-06, 'epoch': 3.32}
{'loss': 0.0682, 'grad_norm': 0.025979790836572647, 'learning_rate': 7.2924444444444455e-06, 'epoch': 3.36}
{'loss': 0.0478, 'grad_norm': 0.20611824095249176, 'learning_rate': 7.114666666666667e-06, 'epoch': 3.4}
{'loss': 0.1025, 'grad_norm': 0.030222438275814056, 'learning_rate': 6.93688888888889e-06, 'epoch': 3.44}
{'loss': 0.0727, 'grad_norm': 0.21306245028972626, 'learning_rate': 6.759111111111112e-06, 'epoch': 3.48}
{'loss': 0.0641, 'grad_norm': 0.022286690771579742, 'learning_rate': 6.581333333333334e-06, 'epoch': 3.52}
{'loss': 0.0775, 'grad_norm': 0.09122312813997269, 'learning_rate': 6.403555555555556e-06, 'epoch': 3.56}
{'loss': 0.0676, 'grad_norm': 0.04455913230776787, 'learning_rate': 6.225777777777779e-06, 'epoch': 3.6}
{'loss': 0.0643, 'grad_norm': 0.07256359606981277, 'learning_rate': 6.048e-06, 'epoch': 3.64}
{'loss': 0.0846, 'grad_norm': 0.034121572971343994, 'learning_rate': 5.870222222222223e-06, 'epoch': 3.68}
{'loss': 0.0841, 'grad_norm': 0.15728238224983215, 'learning_rate': 5.692444444444445e-06, 'epoch': 3.72}
{'loss': 0.0801, 'grad_norm': 0.04691864177584648, 'learning_rate': 5.514666666666667e-06, 'epoch': 3.76}
{'loss': 0.0908, 'grad_norm': 0.027192912995815277, 'learning_rate': 5.336888888888889e-06, 'epoch': 3.8}
{'loss': 0.0864, 'grad_norm': 2.4311370849609375, 'learning_rate': 5.159111111111112e-06, 'epoch': 3.84}
{'loss': 0.0521, 'grad_norm': 0.6531434059143066, 'learning_rate': 4.9813333333333335e-06, 'epoch': 3.88}
{'loss': 0.0504, 'grad_norm': 0.03620877116918564, 'learning_rate': 4.803555555555556e-06, 'epoch': 3.92}
{'loss': 0.0741, 'grad_norm': 0.05637074261903763, 'learning_rate': 4.625777777777778e-06, 'epoch': 3.96}
{'loss': 0.0246, 'grad_norm': 0.031051086261868477, 'learning_rate': 4.4480000000000004e-06, 'epoch': 4.0}
{'eval_loss': 0.42586103081703186, 'eval_accuracy': 0.9132, 'eval_f1': 0.9118244616009752, 'eval_runtime': 4.7491, 'eval_samples_per_second': 526.417, 'eval_steps_per_second': 16.635, 'epoch': 4.0}
{'loss': 0.033, 'grad_norm': 0.035307254642248154, 'learning_rate': 4.270222222222223e-06, 'epoch': 4.04}
{'loss': 0.0559, 'grad_norm': 0.02590685524046421, 'learning_rate': 4.092444444444445e-06, 'epoch': 4.08}
{'loss': 0.0343, 'grad_norm': 0.03623465076088905, 'learning_rate': 3.914666666666667e-06, 'epoch': 4.12}
{'loss': 0.0543, 'grad_norm': 0.1484052985906601, 'learning_rate': 3.736888888888889e-06, 'epoch': 4.16}
{'loss': 0.0535, 'grad_norm': 0.026512525975704193, 'learning_rate': 3.5591111111111114e-06, 'epoch': 4.2}
{'loss': 0.0352, 'grad_norm': 0.028051747009158134, 'learning_rate': 3.3813333333333335e-06, 'epoch': 4.24}
{'loss': 0.0279, 'grad_norm': 1.4801678657531738, 'learning_rate': 3.2035555555555557e-06, 'epoch': 4.28}
{'loss': 0.0547, 'grad_norm': 0.03536466509103775, 'learning_rate': 3.025777777777778e-06, 'epoch': 4.32}
{'loss': 0.0608, 'grad_norm': 0.0278825331479311, 'learning_rate': 2.848e-06, 'epoch': 4.36}
{'loss': 0.0449, 'grad_norm': 3.1185860633850098, 'learning_rate': 2.6702222222222223e-06, 'epoch': 4.4}
{'loss': 0.0453, 'grad_norm': 0.0352393239736557, 'learning_rate': 2.4924444444444445e-06, 'epoch': 4.44}
{'loss': 0.0443, 'grad_norm': 0.02607395313680172, 'learning_rate': 2.3146666666666666e-06, 'epoch': 4.48}
{'loss': 0.034, 'grad_norm': 0.025678424164652824, 'learning_rate': 2.1368888888888892e-06, 'epoch': 4.52}
{'loss': 0.0388, 'grad_norm': 0.027455836534500122, 'learning_rate': 1.9591111111111114e-06, 'epoch': 4.56}
{'loss': 0.0389, 'grad_norm': 0.1204245314002037, 'learning_rate': 1.7813333333333336e-06, 'epoch': 4.6}
{'loss': 0.0233, 'grad_norm': 0.026793593540787697, 'learning_rate': 1.6035555555555558e-06, 'epoch': 4.64}
{'loss': 0.0432, 'grad_norm': 0.02933797612786293, 'learning_rate': 1.4257777777777778e-06, 'epoch': 4.68}
{'loss': 0.0597, 'grad_norm': 0.024905312806367874, 'learning_rate': 1.248e-06, 'epoch': 4.72}
{'loss': 0.0138, 'grad_norm': 0.07814487814903259, 'learning_rate': 1.0702222222222223e-06, 'epoch': 4.76}
{'loss': 0.0095, 'grad_norm': 0.018697097897529602, 'learning_rate': 8.924444444444445e-07, 'epoch': 4.8}
{'loss': 0.0182, 'grad_norm': 0.016997165977954865, 'learning_rate': 7.146666666666667e-07, 'epoch': 4.84}
{'loss': 0.0238, 'grad_norm': 0.09867086261510849, 'learning_rate': 5.368888888888889e-07, 'epoch': 4.88}
{'loss': 0.024, 'grad_norm': 15.31161880493164, 'learning_rate': 3.5911111111111113e-07, 'epoch': 4.92}
{'loss': 0.0509, 'grad_norm': 0.03077675588428974, 'learning_rate': 1.8133333333333337e-07, 'epoch': 4.96}
{'loss': 0.0206, 'grad_norm': 16.581327438354492, 'learning_rate': 3.555555555555556e-09, 'epoch': 5.0}
{'eval_loss': 0.45564335584640503, 'eval_accuracy': 0.9144, 'eval_f1': 0.9139871382636656, 'eval_runtime': 4.7916, 'eval_samples_per_second': 521.742, 'eval_steps_per_second': 16.487, 'epoch': 5.0}
{'train_runtime': 907.8676, 'train_samples_per_second': 110.148, 'train_steps_per_second': 6.884, 'train_loss': 0.15857671858310698, 'epoch': 5.0}
Val metrics: {'eval_loss': 0.26676979660987854, 'eval_accuracy': 0.9156, 'eval_f1': 0.9165678133649664, 'eval_runtime': 4.8909, 'eval_samples_per_second': 511.153, 'eval_steps_per_second': 16.152, 'epoch': 5.0}
Test metrics: {'eval_loss': 0.3026457130908966, 'eval_accuracy': 0.8956, 'eval_f1': 0.8975265017667845, 'eval_runtime': 5.0818, 'eval_samples_per_second': 491.95, 'eval_steps_per_second': 15.546, 'epoch': 5.0}
Evaluation metrics saved to: /home/comp/zhanzhao/comp7015-group/bert/result/distilbert-base-uncased-20251120-113354.json
Total epochs recorded: 5
Training completed!
Validation accuracy: 0.9156
Test accuracy: 0.8956
==========================================
DistilBert training test completed!
==========================================
